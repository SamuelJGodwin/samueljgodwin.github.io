!function(a){window.console||(window.console={}),window.console.log||(window.console.log=function(){});var o=function(){var o=this;o.params={defLat:59,defLng:18,defZoom:1,queryLocationNameWhenLatLngChanges:!0,queryElevationWhenLatLngChanges:!0,mapOptions:{mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,disableDoubleClickZoom:!0,zoomControlOptions:!0,streetViewControl:!1},strings:{markerText:"Drag this Marker",error_empty_field:"Couldn't find coordinates for this place",error_no_results:"Couldn't find coordinates for this place"}},o.vars={ID:null,LATLNG:null,map:null,marker:null,geocoder:null};var s=function(s){o.vars.marker.setPosition(s),o.vars.map.panTo(s),a(o.vars.cssID+".gllpZoom").val(o.vars.map.getZoom()),a(o.vars.cssID+".gllpLongitude").val(s.lng()),a(o.vars.cssID+".gllpLatitude").val(s.lat()),a(o.vars.cssID).trigger("location_changed",a(o.vars.cssID)),o.params.queryLocationNameWhenLatLngChanges&&e(s),o.params.queryElevationWhenLatLngChanges&&r(s)},e=function(s){var e=new google.maps.LatLng(s.lat(),s.lng());o.vars.geocoder.geocode({latLng:e},function(s,e){e==google.maps.GeocoderStatus.OK&&s[1]?a(o.vars.cssID+".gllpLocationName").val(s[1].formatted_address):a(o.vars.cssID+".gllpLocationName").val(""),a(o.vars.cssID).trigger("location_name_changed",a(o.vars.cssID))})},r=function(s){var e=new google.maps.LatLng(s.lat(),s.lng()),r=[e],n={locations:r};o.vars.elevator.getElevationForLocations(n,function(s,e){e==google.maps.ElevationStatus.OK&&s[0]?a(o.vars.cssID+".gllpElevation").val(s[0].elevation.toFixed(3)):a(o.vars.cssID+".gllpElevation").val(""),a(o.vars.cssID).trigger("elevation_changed",a(o.vars.cssID))})},n=function(e,r){if(""==e)return void(r||t(o.params.strings.error_empty_field));o.vars.geocoder.geocode({address:e},function(e,n){n==google.maps.GeocoderStatus.OK?(a(o.vars.cssID+".gllpZoom").val(11),o.vars.map.setZoom(parseInt(a(o.vars.cssID+".gllpZoom").val())),s(e[0].geometry.location)):r||t(o.params.strings.error_no_results)})},t=function(a){alert(a)};return{init:function(e){a(e).attr("id")||(a(e).attr("name")?a(e).attr("id",a(e).attr("name")):a(e).attr("id","_MAP_"+Math.ceil(1e4*Math.random()))),o.vars.ID=a(e).attr("id"),o.vars.cssID="#"+o.vars.ID+" ",o.params.defLat=a(o.vars.cssID+".gllpLatitude").val()?a(o.vars.cssID+".gllpLatitude").val():o.params.defLat,o.params.defLng=a(o.vars.cssID+".gllpLongitude").val()?a(o.vars.cssID+".gllpLongitude").val():o.params.defLng,o.params.defZoom=a(o.vars.cssID+".gllpZoom").val()?parseInt(a(o.vars.cssID+".gllpZoom").val()):o.params.defZoom,o.vars.LATLNG=new google.maps.LatLng(o.params.defLat,o.params.defLng),o.vars.MAPOPTIONS=o.params.mapOptions,o.vars.MAPOPTIONS.zoom=o.params.defZoom,o.vars.MAPOPTIONS.center=o.vars.LATLNG,o.vars.map=new google.maps.Map(a(o.vars.cssID+".gllpMap").get(0),o.vars.MAPOPTIONS),o.vars.geocoder=new google.maps.Geocoder,o.vars.elevator=new google.maps.ElevationService,o.vars.marker=new google.maps.Marker({position:o.vars.LATLNG,map:o.vars.map,title:o.params.strings.markerText,draggable:!0}),google.maps.event.addListener(o.vars.map,"dblclick",function(a){s(a.latLng)}),google.maps.event.addListener(o.vars.marker,"dragend",function(a){s(o.vars.marker.position)}),google.maps.event.addListener(o.vars.map,"zoom_changed",function(s){a(o.vars.cssID+".gllpZoom").val(o.vars.map.getZoom()),a(o.vars.cssID).trigger("location_changed",a(o.vars.cssID))}),a(o.vars.cssID+".gllpUpdateButton").bind("click",function(){var e=a(o.vars.cssID+".gllpLatitude").val(),r=a(o.vars.cssID+".gllpLongitude").val(),n=new google.maps.LatLng(e,r);o.vars.map.setZoom(parseInt(a(o.vars.cssID+".gllpZoom").val())),s(n)}),a(o.vars.cssID+".gllpSearchButton").bind("click",function(){n(a(o.vars.cssID+".gllpSearchField").val(),!1)}),a(document).bind("gllp_perform_search",function(o,s){n(a(s).attr("string"),!0)})}}};a(document).ready(function(){"object"==typeof google&&"object"==typeof google.maps&&a(".gllpLatlonPicker").each(function(){(new o).init(a(this))})}),a(document).bind("location_changed",function(o,s){console.log("changed: "+a(s).attr("id"))})}(jQuery);